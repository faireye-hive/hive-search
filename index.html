<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HiveSense Search ‚Äî Demo</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.5/dist/purify.min.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen">
  <div class="max-w-6xl mx-auto p-4 md:p-6">
    <header class="mb-6">
      <h1 class="text-3xl font-extrabold">HiveSense Search</h1>
      <p class="text-sm text-slate-600">
        Advanced search with filters and link search (shows similar posts)
      </p>
    </header>

    <section class="bg-white p-6 rounded-2xl shadow-md mb-6">
      <form id="searchForm" class="grid grid-cols-1 md:grid-cols-8 gap-3 items-center">
        <input id="q" class="md:col-span-4 p-3 rounded-lg border border-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-300" 
               placeholder=""/>
        
        <select id="truncate" class="p-3 rounded-lg border border-slate-200" title="truncate"> 
          <option value="0">Sem truncar</option>
          <option value="100">truncate=100</option>
          <option value="200" selected>truncate=200</option>
          <option value="500">truncate=500</option>
        </select>
        
        <!-- Bot√µes de ordena√ß√£o -->
        <div id="sortButtons" class="flex rounded-lg border border-slate-200 overflow-hidden md:col-span-1">
          <button type="button" id="sortRelevance" class="sort-btn active flex-1 p-3 text-sm bg-slate-100 hover:bg-slate-200 transition-colors" title="Sort by relevance">
            üîç
          </button>
          <button type="button" id="sortRecent" class="sort-btn flex-1 p-3 text-sm bg-slate-100 hover:bg-slate-200 transition-colors" title="Sort by newest">
            ‚è∞
          </button>
        </div>
        
        <button id="btnSearch" type="submit" 
                class="md:col-span-1 bg-slate-800 text-white p-3 rounded-lg hover:opacity-90 flex justify-center items-center">
          <span id="btnText">Search</span>
          <div id="btnSpinner" class="loading-spinner hidden ml-2"></div>
        </button>
      </form>

      <!-- Filtros ativos -->
      <div id="activeFilters" class="mt-4 hidden">
        <div class="flex flex-wrap gap-2 items-center">
          <span class="text-sm text-slate-600">Filtros ativos:</span>
          <div id="filterBadges" class="flex flex-wrap gap-2"></div>
          <button id="clearFilters" class="text-sm text-red-600 hover:text-red-800 ml-2">
            Limpar filtros
          </button>
        </div>
      </div>

      <!-- Filtro Local -->
      <div id="localFilterContainer" class="mt-4 hidden">
        <div class="bg-gradient-to-r from-slate-50 to-slate-100 p-4 rounded-lg border border-slate-200">
          <div class="flex flex-col md:flex-row md:items-center justify-between gap-3">
            <div class="flex-1">
              <label for="localFilter" class="block text-sm font-medium text-slate-700 mb-1">
                üîç Filtro Local (busca nos posts j√° carregados)
              </label>
              <input 
                id="localFilter" 
                type="text" 
                class="w-full p-3 rounded-lg border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                placeholder="Ex: splinterlands 2024 ou #hive-engine"
              />
              <p class="text-xs text-slate-500 mt-1">
                Busca no t√≠tulo, conte√∫do, autor, tags e data dos posts j√° carregados
              </p>
            </div>
            <div class="flex gap-2 md:flex-col">
              <button id="clearLocalFilter" class="px-4 py-3 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 text-sm whitespace-nowrap">
                Limpar
              </button>
              <button id="advancedFilterToggle" class="px-4 py-3 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 text-sm whitespace-nowrap">
                Filtros Avan√ßados
              </button>
            </div>
          </div>
          
          <!-- Filtros Avan√ßados (inicialmente ocultos) -->
          <div id="advancedFilters" class="mt-4 hidden space-y-3">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
              <div>
                <label class="block text-xs font-medium text-slate-600 mb-1">Data Inicial</label>
                <input id="filterDateStart" type="date" class="w-full p-2 rounded border border-slate-300 text-sm">
              </div>
              <div>
                <label class="block text-xs font-medium text-slate-600 mb-1">Data Final</label>
                <input id="filterDateEnd" type="date" class="w-full p-2 rounded border border-slate-300 text-sm">
              </div>
              <div>
                <label class="block text-xs font-medium text-slate-600 mb-1">Categoria</label>
                <input id="filterCategory" type="text" class="w-full p-2 rounded border border-slate-300 text-sm" placeholder="Ex: hive-196037">
              </div>
              <div>
                <label class="block text-xs font-medium text-slate-600 mb-1">M√≠n. de Votos</label>
                <input id="filterMinVotes" type="number" min="0" class="w-full p-2 rounded border border-slate-300 text-sm" placeholder="0">
              </div>
            </div>
            <div class="flex flex-wrap gap-2 items-center">
              <button id="applyAdvancedFilters" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">
                Aplicar Filtros
              </button>
              <button id="resetAdvancedFilters" class="px-4 py-2 bg-slate-200 text-slate-700 rounded-lg hover:bg-slate-300 text-sm">
                Redefinir
              </button>
            </div>
          </div>
        </div>
        
        <!-- Estat√≠sticas do Filtro -->
        <div id="localFilterStats" class="mt-2 text-sm text-slate-600 hidden">
          <span id="filteredCount">0</span> de <span id="totalCount">0</span> posts correspondem ao filtro
        </div>
      </div>

      <div id="meta" class="mt-4 text-sm text-slate-500"></div>
      <div id="progressContainer" class="hidden">
        <div class="progress-bar">
          <div id="progressFill" class="progress-fill" style="width: 0%"></div>
        </div>
        <div id="progressText" class="text-xs text-slate-500 mt-1"></div>
      </div>

      <!-- Info do post original (para busca por link) -->
      <div id="originalPostInfo" class="mt-4 hidden">
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="font-semibold text-blue-800">Posts similares a:</h3>
              <div id="originalPostDetails" class="text-sm text-blue-600 mt-1"></div>
            </div>
            <button id="closeOriginalPostInfo" class="text-blue-500 hover:text-blue-700">
              ‚úï
            </button>
          </div>
        </div>
      </div>

      <!-- Info do usu√°rio (para busca por @username) -->
      <div id="userInfo" class="mt-4 hidden">
        <div class="bg-green-50 border border-green-200 rounded-lg p-4">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="font-semibold text-green-800">Posts do usu√°rio:</h3>
              <div id="userDetails" class="text-sm text-green-600 mt-1"></div>
            </div>
            <button id="closeUserInfo" class="text-green-500 hover:text-green-700">
              ‚úï
            </button>
          </div>
        </div>
      </div>

      <div id="results" class="mt-4 space-y-4"></div>

      <!-- Pagina√ß√£o -->
      <div id="pagination" class="mt-6 pt-4 border-t border-slate-200 hidden">
        <div class="flex flex-wrap justify-between items-center">
          <div class="text-sm text-slate-600 mb-2 md:mb-0" id="pageInfo"></div>
          <div class="flex space-x-2">
            <button id="prevPage" class="px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 disabled:opacity-50 disabled:cursor-not-allowed">
              ‚Üê Previous
            </button>
            <div class="flex items-center space-x-1" id="pageNumbers"></div>
            <button id="nextPage" class="px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200 disabled:opacity-50 disabled:cursor-not-allowed">
              Next ‚Üí
            </button>
          </div>
        </div>
      </div>
    </section>

    <footer class="mt-6 text-xs text-slate-500">
      <div class="mb-2">
        <strong>Search syntax:</strong>
        <ul class="list-disc pl-5 mt-1 space-y-1">
          <li><code>@username</code> ‚Üí Show only posts from this author.</li>
          <li><code>Post URL</code> ‚Üí Show posts similar to the linked post.</li>
        </ul>
      </div>
      Using the HiveSense API ‚Ä¢ Batch search of 50 posts ‚Ä¢ Similar posts
    </footer>
  </div>
   <script src="app.js"></script>

</body>
</html>